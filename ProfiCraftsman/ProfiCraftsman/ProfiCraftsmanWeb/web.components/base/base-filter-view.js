define(["base/base-view","mixins/bound-form","mixins/kendo-widget-form","mixins/kendo-validator-form"],function(e,i,t,l){"use strict";var n=function(){this.$(".advanced").toggle()},r=function(){var e=this,i=e.options.grid.dataSource,t=i.filter()||{filters:[],logic:"and"};if(e.validateFunc(e)){var l=e.getFilters();_.each(l,function(e){if(e.value){var i=_.filter(t.filters,function(i){return e.field===i.field&&e.operator===i.operator?(i.value=e.value,!0):void 0});i.length||t.filters.push(e)}else{var l=_.findWhere(t.filters,{field:e.field,operator:e.operator}),n=t.filters.indexOf(l);n>-1&&t.filters.splice(n,1)}}),i.filter(t)}},a=e.extend({filter:null,validateFunc:function(e){return e.validate()},getFilters:function(){},initialize:function(){a.__super__.initialize.apply(this,arguments),this.model=new this.filter},render:function(){var e=this;return a.__super__.render.apply(e,arguments),e.$el.delegate("button[type=submit]","click.base-filter-view",function(i){i.preventDefault(),r.call(e)}),e.$el.delegate("button[type=reset]","click.base-filter-view",function(i){i.preventDefault(),e.model.clear().set(e.model.defaults),r.call(e)}),e.$el.delegate(".toggle","click.base-filter-view",_.bind(n,this)),e},close:function(){this.off(".base-filter-view"),a.__super__.close.apply(this,arguments)}});return a.mixin(i),a.mixin(l),a.mixin(t),a});